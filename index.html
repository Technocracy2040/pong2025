<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>PONG</title>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">

<style>
html,body{
  margin:0;
  padding:0;
  background:black;
  overflow:hidden;
  font-family:'Orbitron',sans-serif;
}

canvas{
  display:block;
  margin:auto;
  background:black;
}

/* ===== MENU ===== */
#menu{
  position:fixed;
  inset:0;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  background:
    repeating-linear-gradient(
      45deg,
      #ff69b4 0px,
      #ff69b4 20px,
      silver 20px,
      silver 40px
    );
}

#title{
  font-size:64px;
  letter-spacing:12px;
  color:#ff69b4;
  text-shadow:
    0 0 10px silver,
    0 0 25px hotpink;
  background:linear-gradient(90deg, silver, hotpink, silver);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  margin-bottom:40px;
}

#start{
  font-size:20px;
  color:white;
  animation:blink 1s infinite;
}

@keyframes blink{
  0%,50%,100%{opacity:1}
  25%,75%{opacity:0}
}

#options{
  margin-top:30px;
  color:black;
  background:rgba(255,255,255,0.8);
  padding:15px 25px;
  border-radius:12px;
}

button{
  font-family:inherit;
  font-size:14px;
  padding:6px 12px;
}
</style>
</head>

<body>

<div id="menu">
  <div id="title">PONG</div>
  <div id="start">PRESS X TO START</div>

  <div id="options">
    <label>
      <input type="checkbox" id="soundToggle" checked>
      Sound ON
    </label><br><br>
    First to <b>7</b> points<br>
    Match time: <b>60s</b>
  </div>
</div>

<canvas id="game" width="480" height="640"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let state="menu";
let soundOn=true;
let timer=60;
let maxScore=7;

const paddleH=80,paddleW=10;
let left={x:10,y:280,score:0};
let right={x:460,y:280,score:0};
let ball={x:240,y:320,vx:4,vy:4,r:6};

const beep=(freq=440)=>{
  if(!soundOn) return;
  const a=new AudioContext();
  const o=a.createOscillator();
  const g=a.createGain();
  o.connect(g); g.connect(a.destination);
  o.frequency.value=freq;
  o.start();
  g.gain.exponentialRampToValueAtTime(0.0001,a.currentTime+0.15);
};

function resetBall(){
  ball.x=240; ball.y=320;
  ball.vx*=-1;
}

function startGame(){
  document.getElementById("menu").style.display="none";
  state="play";
  left.score=right.score=0;
  timer=60;
}

document.addEventListener("keydown",e=>{
  if(state==="menu" && e.key.toLowerCase()==="x"){
    beep(880); startGame();
  }
  if(e.key==="p") state=state==="play"?"pause":"play";
});

canvas.addEventListener("touchmove",e=>{
  const t=e.touches[0];
  const rect=canvas.getBoundingClientRect();
  const y=t.clientY-rect.top;
  if(t.clientX<rect.width/2) left.y=y-paddleH/2;
  else right.y=y-paddleH/2;
});

document.getElementById("soundToggle").onchange=e=>{
  soundOn=e.target.checked;
};

function update(){
  if(state!=="play") return;

  ball.x+=ball.vx;
  ball.y+=ball.vy;

  if(ball.y<ball.r||ball.y>640-ball.r){
    ball.vy*=-1; beep(300);
  }

  if(ball.x<20 && ball.y>left.y && ball.y<left.y+paddleH){
    ball.vx*=-1; beep(600);
  }
  if(ball.x>460 && ball.y>right.y && ball.y<right.y+paddleH){
    ball.vx*=-1; beep(600);
  }

  if(ball.x<0){ right.score++; resetBall(); beep(200); }
  if(ball.x>480){ left.score++; resetBall(); beep(200); }

  if(left.score>=maxScore||right.score>=maxScore||timer<=0){
    state="menu";
    document.getElementById("menu").style.display="flex";
  }
}

function draw(){
  ctx.fillStyle="black";
  ctx.fillRect(0,0,480,640);

  ctx.fillStyle="hotpink";
  ctx.fillRect(left.x,left.y,paddleW,paddleH);
  ctx.fillStyle="silver";
  ctx.fillRect(right.x,right.y,paddleW,paddleH);

  ctx.beginPath();
  ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);
  ctx.fillStyle="white";
  ctx.fill();

  ctx.fillStyle="white";
  ctx.fillText(`${left.score}  ${right.score}`,200,40);
  ctx.fillText(`TIME ${timer}`,190,60);
}

setInterval(()=>{
  if(state==="play") timer--;
},1000);

(function loop(){
  update(); draw();
  requestAnimationFrame(loop);
})();
</script>
</body>
</html>
